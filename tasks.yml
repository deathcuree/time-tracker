feature:
  name: Admin Dashboard - Reusable Excel Export
  location: "@/client/src/pages/AdminDashboardPage.tsx"

description: |
  Implement a reusable Export Button in the Admin Dashboard that allows
  exporting all table data (including paginated records) into an Excel file.
  Ensure backend, frontend, and integration work seamlessly together.
  This should be clean, maintainable, and easily reusable for other tables.

requirements:
  frontend:
    - Add a **ExportButton** component:
        - Reusable across Admin Dashboard and other tables.
        - Placed near table toolbar.
        - Handles loading and error states.
        - Disabled until table data or user selection is valid (if applicable).
        - On click, triggers API call to download Excel.
    - Ensure export captures **all table data**, even with pagination.
    - Use existing API client setup for requests.
    - File naming convention: `table-export-{yyyy-mm-dd}.xlsx`.
  
  backend:
    - Add endpoint: `GET /api/admin/table/export`
        - Optional query parameters: `userId`, `filters`, `sort`, `pagination=false` (to get all data).
        - Returns Excel (XLSX) file with all table columns and rows.
    - Secure endpoint for admin-only access.
    - Use existing data fetching logic to respect filters and sorting.
    - Use a library like `exceljs` or `xlsx` to generate Excel file.
    - Set proper `Content-Disposition` headers for file download.

  integration:
    - Frontend API function: `exportTableData(params)`.
    - Hook ExportButton click → call API → download file.
    - Ensure proper handling of large datasets (all pages) from backend.
    - Handle errors gracefully (network, no data, invalid params).

acceptance_criteria:
  - Admin sees ExportButton in Admin Dashboard near the table.
  - Clicking Export downloads all table data into Excel.
  - Columns and order in Excel match table view.
  - Pagination does not prevent any data from being exported.
  - Errors are properly handled with notifications.
  - Only admin users can perform exports.

notes:
  - Reuse existing infrastructure (API client, authentication, table data fetching).
  - Component and backend endpoint should be reusable for future exports.
  - Maintain clean and readable code, following existing project conventions.
